% LDLt factorization
% class 2017-11-13
% page 417

clear;

A = [
   4 -1     1
  -1  4.25  2.75
   1  2.75  3.5
];

% function [l,d] = LDLt_factorization(a)

n = size(A,1);

% for i = 1:n
%     for j = 1:i-1
%         v(j) = l(i,j) * d(j);
%     end    
%    
%     j = 1:i-1;
%     d(i) = A(i,i) - sum(l(i,j)*v(j));
%     
%     for j= i+1:n
%         k = 1:i-1;
%         l(j,i) = ( A(j,i) - sum(l(j,k)*v(k)) ) / d(i);
%     end
%     
% end

% end

L = zeros(n,n);

v(1) = A(1,1);
d(1) = v(1);
L(2:n,1) = A(2:n,1) / v(1);  

for i=2:n
    
    for j = 1:i-1
        v(j) = L(i,j) .* d(j);
    end
    j = 1:i-1;
    v(i) = A(i,i) - sum(L(i,j) * v(j)');
    d(i) = v(i);

    if (i < n)
        j = 1:i-1;
        k = i+1:n;
        L(j,i) = (A(j,i) - L(j,1:i-1) * v(1:i-1)') / v(i);
    end
end
D = diag(d);
% L = L + eye(n);

